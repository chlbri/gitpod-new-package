name: Publish
env:
  key1: ${{secrets.NPM_TOKEN}}


on: 
  workflow_run:
    workflows: [CI]
    types: 
      - completed
    branches: [main, master, dev]
    

jobs:
  on-success:
    if: ${{ github.event.workflow_run.conclusion == 'success' && env.key1 != null }}
    uses: ./.github/workflows/r-publish.yml
    secrets: inherit
     

  on-failure:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    steps:
      - run: echo 'The triggering workflow failed'  